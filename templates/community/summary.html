{% extends "base_2col.html" %}

{% block sectionid %}blog{% endblock %}

{% block title %}Open Thoughts{% endblock %}

{% block billboard %}Open Thoughts{% endblock %}

{% block content-related %}

<h2>Recent <a href="forum/">forum</a> posts</h2>

{% load safe_markup %}
{% load markup %}
{% if latest_posts %}
    <ul>
    {% for post in latest_posts %}
        <li>{{ post.title }}
	  <br></br>
	  <a href='{{ post.url }}'>
	    {{ post.body|firstwords:"cut=100"|markdown:"safe" }}
	  </a></li>
    {% endfor %}
    </ul>
{% else %}
    <p>No forum yet.</p>
{% endif %}

<h2>Recent posts from external sites</h2>

{% if latest_feeds %}
    <ul>
    {% for feed in latest_feeds %}
        <li><h3><a href='{{ feed.url }}'>{{ feed.title }}</a></h3>
	  <ul>
	  {% for item in feed.items %}
	    <li><a href='{{ item.link }}'>{{ item.title }}</a></li>
	  {% endfor %}
	  </ul>
	  </li>
    {% endfor %}
    </ul>
{% else %}
    <p>No forum yet.</p>
{% endif %}



<h3><a href="/community/blog/rss/latest"><img src="/media/images/rss.png" alt="RSS Feed" border="0" width="16" height="16" align="top"></img> RSS Feed - Blog</a></h3>
{% endblock %}

{% block content %}
{% if blog_entries %}
  {% load markup %}
  {% for latest_blog in blog_entries %}
  <p>
  <h2><a href="{{ latest_blog.get_absolute_url }}">{{ latest_blog.headline }}</a></h2>
  <p class="date small">by 
  <strong>{{ latest_blog.author }}</strong>
  on {{ latest_blog.pub_date|date:"F j, Y" }}

  {% load comments %}
  {% get_comment_list for blog.blogitem latest_blog.id as comment_list %}
  {% if comment_list %}
    {% get_comment_count for object as comment_count %}
    (<a href="{{ latest_blog.get_last_comments_url }}">{{ comment_count }} comment{{ comment_count|pluralize }}</a>)
  {% else %}
    ({{ comment_list.count }} comment{{ comment_list.count|pluralize }})
  {% endif %}
  </p>

  <p>
  {{ latest_blog.body|markdown:"safe" }}
  </p>
  </p>
  {% if not forloop.last %}
  <hr></hr>
  {% endif %}
  {% endfor %}
{% endif %}
{% endblock %}
